<div class="space-y-6">
  <!-- Encabezado -->
  <section class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
    <div>
      <p class="text-xs font-semibold uppercase tracking-[0.25em] text-primary">
        Contenido preventivo
      </p>
      <h1
        class="mt-1 font-bold leading-tight break-words
              !text-xl sm:!text-3xl lg:!text-5xl"
      >
        Contenido multimedia de prevención
      </h1>
      <p class="mt-2 text-sm text-text-muted max-w-xl">
        Aquí podrás consultar videos, infografías y artículos enfocados en prevenir lesiones de fútbol
        soccer.
      </p>
    </div>
  </section>

  <!-- Filtros -->
  <section class="bg-app-card/90 border border-app-border rounded-2xl p-4 sm:p-5 space-y-4">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
      <h2 class="text-sm font-semibold">Filtros de contenido</h2>
      <div class="flex flex-wrap gap-2 text-xs">
        <!-- Tipo -->
        <div class="flex items-center gap-2">
          <span class="text-text-muted">Tipo:</span>
          <button
            type="button"
            class="px-2 py-1 rounded-full border text-[11px] transition"
            [ngClass]="selectedType === 'todos'
              ? 'bg-primary text-white border-primary'
              : 'border-app-border text-text-muted hover:border-primary hover:text-primary'"
            (click)="selectedType = 'todos'"
          >
            Todos
          </button>
          <button
            type="button"
            class="px-2 py-1 rounded-full border text-[11px] transition"
            [ngClass]="selectedType === 'video'
              ? 'bg-primary text-white border-primary'
              : 'border-app-border text-text-muted hover:border-primary hover:text-primary'"
            (click)="selectedType = 'video'"
          >
            Videos
          </button>
          <button
            type="button"
            class="px-2 py-1 rounded-full border text-[11px] transition"
            [ngClass]="selectedType === 'infografia'
              ? 'bg-primary text-white border-primary'
              : 'border-app-border text-text-muted hover:border-primary hover:text-primary'"
            (click)="selectedType = 'infografia'"
          >
            Infografías
          </button>
          <button
            type="button"
            class="px-2 py-1 rounded-full border text-[11px] transition"
            [ngClass]="selectedType === 'articulo'
              ? 'bg-primary text-white border-primary'
              : 'border-app-border text-text-muted hover:border-primary hover:text-primary'"
            (click)="selectedType = 'articulo'"
          >
            Artículos
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Estado de carga / error -->
  <div *ngIf="loading" class="text-xs text-text-muted">
    Cargando contenido preventivo...
  </div>
  <div *ngIf="!loading && errorMessage" class="text-xs text-red-400">
    {{ errorMessage }}
  </div>

  <!-- Grid de contenido (tarjetas) -->
  <section
    *ngIf="!loading && !errorMessage"
    class="grid gap-4 md:grid-cols-2 xl:grid-cols-3"
  >
    <article
      *ngFor="let item of filteredContents"
      class="bg-app-card/90 border border-app-border rounded-2xl p-4 sm:p-5 flex flex-col justify-between shadow-lg shadow-slate-950/50 cursor-pointer hover:border-primary/60 hover:bg-slate-900 transition"
      (click)="selectContent(item)"
    >
      <div class="space-y-2">
        <div class="flex items-center justify-between gap-2">
          <span
            class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[11px]"
            [ngClass]="{
              'bg-primary/10 text-primary': item.type === 'video',
              'bg-accent/10 text-accent': item.type === 'infografia',
              'bg-warning/10 text-warning': item.type === 'articulo'
            }"
          >
            {{ getTypeLabel(item.type) }}
          </span>
          <span class="text-[11px] text-text-muted">
            {{ item.duration }}
          </span>
        </div>

        <h3 class="text-sm font-semibold">
          {{ item.title }}
        </h3>
        <p class="text-xs text-text-muted">
          {{ item.description }}
        </p>

        <div class="flex flex-wrap gap-2 mt-2 text-[11px] text-text-muted">
          <span class="rounded-full border border-app-border px-2 py-0.5">
            Zona: {{ item.focusZone }}
          </span>
        </div>
      </div>

      <div class="mt-4 flex flex-col gap-2 text-[11px] text-text-muted">
        <span>
          Fuente: <strong>{{ item.sourceName }}</strong>
        </span>
        <a
          class="self-end rounded-full border border-primary/60 bg-primary/10 px-3 py-1 text-[11px] text-primary hover:bg-primary/20 transition"
          [href]="item.sourceUrl"
          target="_blank"
          rel="noopener noreferrer"
          (click)="$event.stopPropagation()"
        >
          Ver contenido original
        </a>
      </div>
    </article>
  </section>

  <!-- Visor del contenido seleccionado -->
  <section
    *ngIf="selectedContent"
    class="bg-app-card/90 border border-app-border rounded-2xl p-4 sm:p-5 space-y-3 mt-4"
  >
    <p class="text-xs font-semibold uppercase tracking-[0.2em] text-primary">
      Contenido seleccionado
    </p>
    <h2 class="text-sm sm:text-base font-semibold">
      {{ selectedContent.title }}
    </h2>
    <p class="text-xs text-text-muted">
      {{ selectedContent.description }}
    </p>

    <!-- Render según tipo -->
    <ng-container [ngSwitch]="selectedContent.type">

      <!-- Video -->
      <div *ngSwitchCase="'video'">
        <div class="aspect-video rounded-xl overflow-hidden border border-app-border mt-2"
             *ngIf="selectedContent.embedUrl">
          <iframe
            class="w-full h-full"
            [src]="selectedContent.embedUrl | safeUrl"
            frameborder="0"
            allowfullscreen
          ></iframe>
        </div>
      </div>

      <!-- Infografía -->
      <div *ngSwitchCase="'infografia'">
        <div class="mt-3" *ngIf="selectedContent.imageUrl">
          <img
            [src]="selectedContent.imageUrl"
            [alt]="selectedContent.title"
            class="w-full max-h-[500px] object-contain rounded-xl border border-app-border"
          />
        </div>
      </div>

      <!-- Artículo / resumen -->
      <div *ngSwitchCase="'articulo'">
        <div class="mt-3 space-y-2">
          <p class="text-[11px] text-text-muted">
            Resumen basado en la fuente consultada:
          </p>
          <ul class="list-disc list-inside text-xs text-text-muted" *ngIf="selectedContent.keyPoints?.length">
            <li *ngFor="let point of selectedContent.keyPoints">
              {{ point }}
            </li>
          </ul>
        </div>
      </div>

    </ng-container>

    <div class="pt-3 mt-2 border-t border-app-border text-[11px] text-text-muted flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
      <span>
        Fuente original: <strong>{{ selectedContent.sourceName }}</strong>
      </span>
      <a
        class="inline-flex items-center justify-center rounded-full border border-primary/60 bg-primary/10 px-3 py-1 text-[11px] text-primary hover:bg-primary/20 transition"
        [href]="selectedContent.sourceUrl"
        target="_blank"
        rel="noopener noreferrer"
      >
        Ver publicación original
      </a>
    </div>
  </section>
</div>
