<div class="w-full max-w-5xl mx-auto space-y-6">
  <!-- Encabezado -->
  <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3">
    <div>
      <p class="text-xs font-semibold uppercase tracking-[0.25em] text-primary">
        Perfil del jugador
      </p>
      <h1 class="mt-1 text-2xl sm:text-3xl font-bold">
        Información general
      </h1>
      <p class="mt-2 text-sm text-text-muted max-w-xl">
        Revise y actualice sus datos personales y deportivos. Esta información se utiliza para personalizar
        las recomendaciones de prevención de lesiones.
      </p>
    </div>

    <button
      type="button"
      class="inline-flex items-center justify-center rounded-xl bg-primary px-4 py-2 text-xs font-semibold text-white shadow-lg shadow-primary/30 hover:bg-primary-dark transition"
      (click)="toggleEdit()"
    >
      {{ editing ? 'Guardar cambios' : 'Editar perfil' }}
    </button>
  </div>

  <!-- Datos principales -->
  <div class="grid gap-4 md:grid-cols-3">
    <div class="md:col-span-2 bg-app-card border border-app-border rounded-2xl p-4 sm:p-5 space-y-4">
      <h2 class="text-sm font-semibold">Datos personales</h2>

      <div class="grid sm:grid-cols-2 gap-4 text-sm">
        <!-- Nombre -->
        <div class="space-y-1">
          <label class="text-xs text-text-muted">Nombre completo</label>
          <ng-container *ngIf="!editing; else nombreEdit">
            <p class="font-medium">
              {{ profile.fullName || 'Sin nombre capturado' }}
            </p>
          </ng-container>
          <ng-template #nombreEdit>
            <input
              [(ngModel)]="profile.fullName"
              class="w-full rounded-lg border border-app-border bg-slate-900 px-3 py-2 text-sm outline-none focus:border-primary focus:ring-2 focus:ring-primary/40"
            />
          </ng-template>
        </div>

        <!-- Correo -->
        <div class="space-y-1">
          <label class="text-xs text-text-muted">Correo</label>
          <p class="font-medium text-text-muted">
            {{ profile.email || 'Sin correo' }}
          </p>
        </div>

        <!-- Rol -->
        <div class="space-y-1">
          <label class="text-xs text-text-muted">Rol en el equipo</label>
          <ng-container *ngIf="!editing; else rolEdit">
            <p class="font-medium">
              {{ getRoleLabel(profile.role) || 'Sin rol' }}
            </p>
          </ng-container>
          <ng-template #rolEdit>
            <select
              [(ngModel)]="profile.role"
              class="w-full rounded-lg border border-app-border bg-slate-900 px-3 py-2 text-sm outline-none focus:border-primary focus:ring-2 focus:ring-primary/40"
            >
              <option value="player">Jugador</option>
              <option value="coach">Entrenador</option>
              <option value="staff">Staff médico</option>
            </select>
          </ng-template>
        </div>

        <!-- Posición -->
        <div class="space-y-1">
          <label class="text-xs text-text-muted">Posición principal</label>
          <ng-container *ngIf="!editing; else posicionEdit">
            <p class="font-medium">
              {{ profile.position || 'Sin posición registrada' }}
            </p>
          </ng-container>
          <ng-template #posicionEdit>
            <input
              [(ngModel)]="profile.position"
              class="w-full rounded-lg border border-app-border bg-slate-900 px-3 py-2 text-sm outline-none focus:border-primary focus:ring-2 focus:ring-primary/40"
              placeholder="Ejemplo: Defensa central"
            />
          </ng-template>
        </div>

        <!-- Edad (solo lectura, viene de la fecha de nacimiento) -->
        <div class="space-y-1">
          <label class="text-xs text-text-muted">Edad</label>
          <p class="font-medium">
            {{ profile.age ? (profile.age + ' años') : 'Sin fecha de nacimiento' }}
          </p>
          <p class="text-[11px] text-text-muted">
            (Calculada automáticamente a partir de tu fecha de nacimiento del registro)
          </p>
        </div>

        <!-- Dominancia -->
        <div class="space-y-1">
          <label class="text-xs text-text-muted">Pierna dominante</label>
          <ng-container *ngIf="!editing; else piernaEdit">
            <p class="font-medium">
              {{
                profile.dominantLeg === 'derecha'
                  ? 'Derecha'
                  : profile.dominantLeg === 'izquierda'
                  ? 'Izquierda'
                  : profile.dominantLeg === 'ambas'
                  ? 'Ambas'
                  : 'No especificado'
              }}
            </p>
          </ng-container>
          <ng-template #piernaEdit>
            <select
              [(ngModel)]="profile.dominantLeg"
              class="w-full rounded-lg border border-app-border bg-slate-900 px-3 py-2 text-sm outline-none focus:border-primary focus:ring-2 focus:ring-primary/40"
            >
              <option value="derecha">Derecha</option>
              <option value="izquierda">Izquierda</option>
              <option value="ambas">Ambas</option>
            </select>
          </ng-template>
        </div>
      </div>
    </div>

    <!-- Bloque de métricas resumidas -->
    <div class="bg-app-card border border-app-border rounded-2xl p-4 sm:p-5 space-y-3 text-sm">
      <h2 class="text-sm font-semibold">Resumen deportivo</h2>

      <div class="space-y-2 text-xs text-text-muted">
        <div class="flex justify-between">
          <span>Partidos por semana</span>
          <span class="font-medium text-text-main">
            {{ profile.matchesPerWeek }}
          </span>
        </div>
        <div class="flex justify-between">
          <span>Entrenamientos por semana</span>
          <span class="font-medium text-text-main">
            {{ profile.trainingsPerWeek }}
          </span>
        </div>
        <div class="flex justify-between">
          <span>Historial de lesiones</span>
          <span
            class="font-medium"
            [ngClass]="profile.injuryHistory ? 'text-warning' : 'text-accent'"
          >
            {{ profile.injuryHistory ? 'Sí' : 'No reportado' }}
          </span>
        </div>
      </div>

      <p class="mt-2 text-xs text-text-muted">
        Estos datos se toman como base para ajustar los niveles de carga sugeridos y las recomendaciones de recuperación.
      </p>
    </div>
  </div>

  <!-- Historial de lesiones -->
  <div class="bg-app-card border border-app-border rounded-2xl p-4 sm:p-5 space-y-3">
    <div class="flex items-center justify-between">
      <h2 class="text-sm font-semibold">Historial de lesiones</h2>
      <span class="text-[11px] text-text-muted">
        Información relevante para la prevención personalizada.
      </span>
    </div>

    <ng-container *ngIf="profile.injuries.length; else noInjuries">
      <ul class="space-y-2 text-xs text-text-muted">
        <li *ngFor="let injury of profile.injuries" class="flex items-start gap-2">
          <span class="mt-1 h-2 w-2 rounded-full bg-danger"></span>
          <div>
            <p class="font-medium text-text-main">
              {{ injury.zone }} · {{ injury.severity }}
            </p>
            <p>{{ injury.description }}</p>
            <p class="text-[11px] text-text-muted">
              Fecha aproximada: {{ injury.date }}
            </p>
          </div>
        </li>
      </ul>
    </ng-container>

    <ng-template #noInjuries>
      <p class="text-xs text-text-muted">
        No se ha registrado ningún antecedente de lesión. En caso de existir, es importante capturarlos
        para mejorar la precisión de las recomendaciones.
      </p>
    </ng-template>
  </div>
</div>